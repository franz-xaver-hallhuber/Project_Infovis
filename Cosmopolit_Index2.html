<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>The Munich Cosmopolit Index</title>
    <link rel="stylesheet" href="cosmoStyle.css">

    <script type="text/javascript" src="cosmoScript.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script>


    <script>
        $(document).ready(function(){
            var svgElementInHTMLSite = document.getElementById("alphasvg");

            //it's important to add an load event listener to the object, as it will load the svg doc asynchronously
            svgElementInHTMLSite.addEventListener("load",function(){
                var svgDoc = svgElementInHTMLSite.contentDocument; //get the inner DOM of alpha.svg
                var svgRoot  = svgDoc.documentElement;

                var selectedArea;
                var startPoint;
                var endPoint;


                svgRoot.addEventListener("mousemove", function(e){

                    if(startPoint)
                        drawConnection(svgDoc, startPoint, getCursorPosition(svgRoot, e));
                })


                var allAreas = svgRoot.getElementsByTagName("path");
                for (var i=0; i < allAreas.length; i++) {

                    allAreas[i].addEventListener("mouseover", function(e){

                        svgRoot.getElementById("area-name").textContent = e.target.id;

                    });


                    allAreas[i].addEventListener("click", function(e){

                        var eventArea = e.target;

                        // Deaktiviere Visualisierung, wenn ich erneut auf das aktive Element klicke
                        if($(selectedArea)[0] === $(eventArea)[0]){
                            toggleClass($(selectedArea), "selected");
                            selectedArea = null;
                            startPoint = null;
                            removeById(svgRoot, "currentLine");
                            removeById(svgRoot, "currentLineShadow");

                        } else {    // Ansonsten ist das gerade geklickte Element das neue aktive Element

                        toggleClass($(selectedArea), "selected");
                        toggleClass($(eventArea), "selected");

                        selectedArea = eventArea;
                        startPoint = getCursorPosition(svgRoot, e);
                            console.log("id=\""+e.target.id+"\" x=\""+startPoint.x+"\" y=\""+startPoint.y+"\"");

                        }
                    })
                }

            },false);
        })
    </script>

    <!--
    http://www.mstatistik-muenchen.de/indikatorenatlas/html5/atlas.html?indicator=i57&date=2014
    https://upload.wikimedia.org/wikipedia/commons/5/50/M%C3%BCnchen_-_Stadtbezirke_und_Stadtbezirksteile_%28Karte%29.svg
    http://stackoverflow.com/questions/11808860/arrow-triangles-on-my-svg-line
    -->

    <style>

    </style>
</head>
<body>

<object data="muenchen_exportiert.svg" type="image/svg+xml" id="alphasvg"></object>






</body>
</html>